# Web Pentesting Plan of Attack

Based on PortSwigger Web Security Academy - All Topics

Last Updated: 2025-10-01

---

## Table of Contents

### Server-side Vulnerabilities
1. [SQL Injection](#sql-injection)
2. [Authentication](#authentication)
3. [Path Traversal](#path-traversal)
4. [Command Injection](#command-injection)
5. [Business Logic Vulnerabilities](#business-logic-vulnerabilities)
6. [Information Disclosure](#information-disclosure)
7. [Access Control](#access-control)
8. [File Upload Vulnerabilities](#file-upload-vulnerabilities)
9. [Race Conditions](#race-conditions)
10. [Server-Side Request Forgery (SSRF)](#server-side-request-forgery-ssrf)
11. [XXE Injection](#xxe-injection)
12. [NoSQL Injection](#nosql-injection)
13. [API Testing](#api-testing)
14. [Web Cache Deception](#web-cache-deception)

### Client-side Vulnerabilities
15. [Cross-Site Scripting (XSS)](#cross-site-scripting-xss)
16. [Cross-Site Request Forgery (CSRF)](#cross-site-request-forgery-csrf)
17. [Cross-Origin Resource Sharing (CORS)](#cross-origin-resource-sharing-cors)
18. [Clickjacking](#clickjacking)
19. [DOM-based Vulnerabilities](#dom-based-vulnerabilities)
20. [WebSockets](#websockets)

### Advanced Topics
21. [Insecure Deserialization](#insecure-deserialization)
22. [Web LLM Attacks](#web-llm-attacks)
23. [GraphQL API Vulnerabilities](#graphql-api-vulnerabilities)
24. [Server-Side Template Injection](#server-side-template-injection)
25. [Web Cache Poisoning](#web-cache-poisoning)
26. [HTTP Host Header Attacks](#http-host-header-attacks)
27. [HTTP Request Smuggling](#http-request-smuggling)
28. [OAuth Authentication](#oauth-authentication)
29. [JWT Attacks](#jwt-attacks)
30. [Prototype Pollution](#prototype-pollution)
31. [Essential Skills](#essential-skills)

---

## Server-side Vulnerabilities

### SQL Injection
**URL:** https://portswigger.net/web-security/sql-injection

**Description:**
SQL injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database.

**Attack Vectors:**
- Retrieving hidden data from database tables
- Subverting application logic to bypass authentication
- Extracting data from other database tables using UNION attacks
- Blind SQL injection using conditional responses
- Blind SQL injection using time delays
- Out-of-band network interactions for data exfiltration

**Bypass Techniques:**
- Using comment indicators (`--`, `#`) to modify query logic
- Injecting `OR 1=1` to return all results
- Manipulating query conditions with boolean logic
- Exploiting second-order (stored) SQL injection
- Using XML/JSON encoding to obfuscate attacks
- Avoiding string concatenation detection

**Key Points:**
- First-order injection: immediate execution from HTTP request
- Second-order injection: stored and executed later
- Prevention: use parameterized queries/prepared statements
- Avoid string concatenation in SQL queries
- Implement input validation and whitelisting
- Impact: unauthorized data access, potential server compromise

---

### Authentication
**URL:** https://portswigger.net/web-security/authentication

**Description:**
Authentication vulnerabilities can allow attackers to gain access to sensitive data and functionality by compromising user identity verification mechanisms.

**Attack Vectors:**
- Brute-force attacks on passwords and usernames
- Username enumeration through error messages
- Bypassing multi-factor authentication (MFA)
- Exploiting password reset mechanisms
- Attacking OAuth authentication flows
- Session fixation attacks

**Bypass Techniques:**
- Circumventing account locking protections
- Exploiting flawed verification logic
- Manipulating authentication tokens
- Brute-forcing two-factor authentication codes
- IP rotation to avoid rate limiting
- Response manipulation to bypass checks

**Key Points:**
- Distinguish authentication (who you are) vs authorization (what you can do)
- Vulnerabilities arise from weak brute-force protection
- Logic flaws in implementation are common
- Improper mechanism design creates exploits
- High-privilege account compromise = potential full system takeover
- Always test password reset functionality separately

---

### Path Traversal
**URL:** https://portswigger.net/web-security/file-path-traversal

**Description:**
Path traversal allows attackers to read arbitrary files on a server, including credentials, application code, and OS files.

**Attack Vectors:**
- Exploiting unsanitized file path inputs
- Using directory traversal sequences (`../`, `..\`)
- Manipulating file path parameters in URLs
- Reading sensitive system files like `/etc/passwd`
- Accessing application configuration files

**Bypass Techniques:**
- Use absolute file paths (e.g., `/etc/passwd`)
- Nested traversal sequences (`....//`, `....\/`)
- URL encoding traversal characters (`%2e%2e%2f`)
- Double URL encoding (`%252e%252e%252f`)
- Null byte termination (`../../../etc/passwd%00.png`)
- Using different directory separator variations

**Key Points:**
- Avoid passing user input to filesystem APIs
- Validate input against a whitelist of allowed values
- Use platform filesystem APIs to canonicalize paths
- Verify canonicalized path starts with expected base directory
- Impact: reading sensitive files, server compromise, credential theft
- Can lead to further attacks with gained information

---

### Command Injection
**URL:** https://portswigger.net/web-security/os-command-injection

**Description:**
OS command injection allows an attacker to execute operating system commands on the server, potentially compromising the application and infrastructure.

**Attack Vectors:**
- Command separators: `&`, `&&`, `|`, `||`, `;`, newline
- Inline command execution: backticks, `$()`
- Blind injection using time delays (`ping`)
- Output redirection to accessible files
- Out-of-band network interactions (DNS, HTTP)

**Bypass Techniques:**
- Terminating quoted contexts with `'` or `"`
- Chaining commands with different separators
- Exploiting shell metacharacters across OS types
- Using variable expansion
- Exploiting wildcard characters
- Injecting into command arguments

**Key Points:**
- Detecting blind vulnerabilities requires creative techniques
- Time-based detection: `ping -c 10 127.0.0.1`
- Prevention: avoid calling OS commands directly
- Use platform APIs instead of shell execution
- Implement strict input validation
- Whitelist permitted values only
- Validate as numbers or alphanumeric characters

---

### Business Logic Vulnerabilities
**URL:** https://portswigger.net/web-security/logic-flaws

**Description:**
Business logic vulnerabilities are flaws in the design and implementation of an application that allow an attacker to elicit unintended behavior.

**Attack Vectors:**
- Circumventing intended application rules
- Manipulating legitimate functionality for malicious purposes
- Exploiting unexpected application states
- Bypassing client-side controls
- Submitting unconventional input
- Making unauthorized changes to transaction-critical values

**Bypass Techniques:**
- Exploiting excessive trust in client-side controls
- Submitting requests in unexpected sequences
- Making flawed assumptions about user behavior
- Manipulating domain-specific application logic
- Price manipulation in e-commerce flows
- Quantity manipulation (negative numbers)

**Key Points:**
- Often unique to specific applications
- Require human insight to detect
- Automated scanning rarely finds these
- Prevention: understand application domain thoroughly
- Document design and data flows clearly
- Write comprehensible, maintainable code
- Validate all user inputs server-side
- Test edge cases and unexpected interactions
- Don't assume user will follow intended workflow

---

### Information Disclosure
**URL:** https://portswigger.net/web-security/information-disclosure

**Description:**
Information disclosure is when a website unintentionally reveals sensitive information to its users, including user data, commercial information, and technical details.

**Attack Vectors:**
- Fuzzing website responses for errors
- Analyzing error messages for system details
- Exploring directory listings
- Examining developer comments in source code
- Investigating backup files (`.bak`, `.old`, `.swp`)
- Probing version control history (`.git`, `.svn`)
- Analyzing configuration settings

**Bypass Techniques:**
- Engineering informative responses through invalid input
- Manipulating input to trigger detailed error messages
- Exploring alternative request methods (OPTIONS, TRACE)
- Examining different application states
- Using automated fuzzing tools
- Analyzing HTTP headers for version information

**Key Points:**
- Remove internal content from public environments
- Disable debugging features in production
- Use generic error messages
- Audit code for potential disclosure risks
- Train development teams on sensitive information handling
- Severity depends on exploitability, not just presence
- Common sources: error messages, debug info, comments, backup files

---

### Access Control
**URL:** https://portswigger.net/web-security/access-control

**Description:**
Access control restricts user actions and resource access based on authentication and session management. Vulnerabilities occur when users can perform unauthorized actions or access restricted resources.

**Attack Vectors:**
- Vertical privilege escalation: gaining higher-privilege functionality
- Horizontal privilege escalation: accessing other users' resources
- Parameter manipulation in URLs or POST body
- URL tampering to access admin pages
- Exploiting unprotected functionality
- Abusing platform misconfigurations

**Bypass Techniques:**
- Modifying hidden fields or cookies
- Manipulating URL parameters (user IDs, roles)
- Using alternative HTTP methods (POST → GET)
- Exploiting URL-matching discrepancies
- Leveraging platform headers (`X-Original-URL`, `X-Rewrite-URL`)
- Manipulating Referer headers
- Exploiting multi-step process flaws

**Key Points:**
- Insecure Direct Object References (IDOR) are common
- Multi-step processes may have partial protection
- Context-dependent controls can be bypassed
- Prevention: deny access by default
- Use centralized access control mechanisms
- Implement thorough testing at code level
- Avoid relying on obfuscation for security
- Never trust client-side access controls

---

### File Upload Vulnerabilities
**URL:** https://portswigger.net/web-security/file-upload

**Description:**
File upload vulnerabilities occur when web servers allow users to upload files without sufficient validation, potentially enabling remote code execution or system compromise.

**Attack Vectors:**
- Uploading web shells for remote code execution
- Bypassing file type validation
- Exploiting race conditions in file processing
- Uploading client-side scripts for XSS
- Manipulating file metadata and extensions
- Path traversal in filename

**Bypass Techniques:**
- Obfuscating file extensions (`exploit.php.jpg`, `exploit.php5`)
- Using alternative file extensions (`.phtml`, `.php3`, `.php4`)
- Manipulating `Content-Type` headers
- Inserting malicious code into image metadata (EXIF)
- Exploiting parsing inconsistencies
- Polyglot files (valid as multiple file types)
- Null byte injection in filename

**Key Points:**
- Use strict file extension whitelisting
- Validate file contents, not just extensions
- Rename uploaded files to prevent execution
- Use established file upload frameworks
- Implement comprehensive server-side validation
- Store uploads outside web root when possible
- Prevent direct access to uploaded files
- Impact: RCE, server compromise, stored XSS, DoS

---

### Race Conditions
**URL:** https://portswigger.net/web-security/race-conditions

**Description:**
Race condition vulnerabilities occur when websites process concurrent requests without adequate safeguards, creating "collisions" that cause unintended application behavior.

**Attack Vectors:**
- Limit overrun attacks (exceeding business logic limits)
- Multi-endpoint race conditions
- Hidden multi-step sequence exploits
- Parallel request techniques
- Session-based attacks
- Time-sensitive authentication bypasses

**Bypass Techniques:**
- Sending multiple simultaneous requests
- Exploiting temporary sub-states in processing
- Manipulating session handling
- Abusing rate/resource limits
- Using Burp Repeater's single-packet attack
- Turbo Intruder extension for precise timing
- HTTP/2 request tunneling

**Key Points:**
- Methodology: Predict → Probe → Prove
- Single-endpoint and multi-endpoint variants
- Partial construction race conditions
- Session-based locking mechanism bypasses
- Prevention: make state changes atomic
- Use database transaction features
- Avoid mixing data from different storage sources
- Implement robust session handling
- Leverage datastore integrity constraints

---

### Server-Side Request Forgery (SSRF)
**URL:** https://portswigger.net/web-security/ssrf

**Description:**
Server-side request forgery is a web security vulnerability that allows an attacker to cause the server-side application to make requests to an unintended location.

**Attack Vectors:**
- Exploiting trust relationships with internal servers
- Accessing internal/administrative interfaces
- Targeting back-end systems (non-routable IPs)
- Manipulating URL parameters
- Accessing cloud metadata services
- Port scanning internal network

**Bypass Techniques:**
- Alternative IP representations (`2130706433` for `127.0.0.1`)
- Using custom domain redirects pointing to localhost
- URL encoding obfuscation
- Leveraging open redirection vulnerabilities
- Exploiting inconsistent URL parsing
- DNS rebinding attacks
- Using IPv6 addresses

**Key Points:**
- SSRF against the server itself (localhost attacks)
- SSRF against back-end systems
- Blind SSRF vulnerabilities
- Hidden attack surfaces: Referer header, XML data
- Cloud metadata endpoints: `169.254.169.254`
- Prevention: whitelist allowed destinations
- Validate and sanitize all URL inputs
- Disable unnecessary URL schemas
- Use network segmentation

---

### XXE Injection
**URL:** https://portswigger.net/web-security/xxe

**Description:**
XML external entity injection is a web security vulnerability that allows an attacker to interfere with an application's processing of XML data.

**Attack Vectors:**
- File retrieval: defining external entities to read server filesystem
- Server-side request forgery (SSRF) via XML entities
- Blind XXE exploitation
- Out-of-band data exfiltration
- Exploiting XInclude attacks
- File upload exploitation (malicious SVG)

**Bypass Techniques:**
- XInclude attacks when XML can't be modified directly
- File upload exploitation with SVG files
- Modifying content types to introduce XML
- XML encoding to obfuscate attacks
- Using parameter entities for blind XXE
- Error-based XXE exploitation

**Key Points:**
- Detecting blind XXE via error messages
- Exploiting DTD (Document Type Definition)
- Prevention: disable external entity resolution
- Disable XML feature support in parsing libraries
- Use less complex data formats (JSON) when possible
- Impact: file retrieval, SSRF, data exfiltration
- Particularly dangerous with SOAP services

---

### NoSQL Injection
**URL:** https://portswigger.net/web-security/nosql-injection

**Description:**
NoSQL injection allows attackers to manipulate database queries in non-relational databases, potentially bypassing authentication, extracting data, causing DoS, or executing code.

**Attack Vectors:**
- Syntax injection: breaking query syntax
- Operator injection: manipulating database operators
- JavaScript injection: exploiting JavaScript evaluation
- Conditional attacks: influencing query logic
- Character-by-character data extraction

**Bypass Techniques:**
- Injecting always-true conditions (`'||'1'=='1`)
- Using null characters to truncate queries
- Leveraging `$ne` (not equal) operators
- Using `$in` operators to bypass authentication
- Extracting data with regex patterns
- JavaScript injection in MongoDB
- Exploiting `$where` clauses

**Key Points:**
- MongoDB-specific injection techniques
- Timing-based injection attacks
- Field name discovery through injection
- Data exfiltration strategies
- Prevention: sanitize and validate user input
- Use parameterized queries
- Apply allowlist of accepted keys
- Disable JavaScript evaluation when possible

---

### API Testing
**URL:** https://portswigger.net/web-security/api-testing

**Description:**
APIs enable software systems to communicate and share data. API testing is crucial for identifying vulnerabilities that could compromise confidentiality, integrity, and availability.

**Attack Vectors:**
- Endpoint discovery and mapping
- HTTP method manipulation (GET, POST, PATCH, DELETE)
- Content type testing
- Hidden parameter identification
- Mass assignment exploitation
- Server-side parameter pollution
- Probing unsupported/unintended functionality

**Bypass Techniques:**
- Changing HTTP methods to bypass restrictions
- Modifying `Content-Type` headers
- Injecting unexpected parameters
- Exploiting mass assignment vulnerabilities
- Manipulating query strings and REST paths
- Using tools: Burp Intruder, Param Miner

**Key Points:**
- API reconnaissance is critical first step
- Documentation analysis reveals attack surface
- Endpoint identification through various methods
- Parameter fuzzing uncovers hidden inputs
- Tools: Burp Suite, JS Link Finder, OpenAPI Parser
- Testing approach: Discover → Analyze → Test → Exploit
- Check for excessive data exposure
- Validate rate limiting and authentication

---

### Web Cache Deception
**URL:** https://portswigger.net/web-security/web-cache-deception

**Description:**
Web cache deception tricks a web cache into storing sensitive, dynamic content by exploiting discrepancies between cache and origin server request handling.

**Attack Vectors:**
- Manipulating URL paths to force caching of dynamic content
- Exploiting path mapping differences
- Exploiting delimiter processing differences
- Exploiting path normalization differences
- Adding static file extensions to dynamic resources

**Bypass Techniques:**
- Encoding delimiters to bypass parsing
- Using path traversal sequences
- Exploiting inconsistent URL path interpretation
- Manipulating static directory cache rules
- Manipulating file name cache rules
- Appending `.css`, `.js`, `.jpg` to dynamic URLs

**Key Points:**
- Path mapping discrepancies between cache/origin
- Delimiter decoding variations
- Static directory cache rule exploitation
- File name cache rule attacks
- Prevention: use `Cache-Control: no-store, private`
- Configure CDN settings carefully
- Verify consistent URL interpretation
- Never cache personalized content

---

## Client-side Vulnerabilities

### Cross-Site Scripting (XSS)
**URL:** https://portswigger.net/web-security/cross-site-scripting

**Description:**
Cross-site scripting (XSS) is a web security vulnerability that allows an attacker to compromise user interactions with a vulnerable application by injecting malicious JavaScript.

**Attack Vectors:**
- Reflected XSS: script from current HTTP request
- Stored XSS: script stored in database
- DOM-based XSS: vulnerability in client-side code
- Injection in input fields, URL parameters, headers
- Injection in user-submitted content
- Context-specific attacks (HTML, JavaScript, attributes)

**Bypass Techniques:**
- Circumventing input filters with encoding
- Exploiting different context vulnerabilities
- Using various event handlers (`onerror`, `onload`)
- Encoding techniques to obfuscate scripts
- Leveraging client-side template injection
- Breaking out of JavaScript strings
- Exploiting attribute contexts

**Key Points:**
- Impact: session hijacking, credential theft, defacement
- Can impersonate users and perform actions
- Prevention: filter input on arrival
- Encode data on output (context-aware)
- Use Content Security Policy (CSP)
- Implement strict input validation
- HTMLEncode user input in HTML context
- JavaScriptEncode in JavaScript context
- Never insert untrusted data into dangerous contexts

---

### Cross-Site Request Forgery (CSRF)
**URL:** https://portswigger.net/web-security/csrf

**Description:**
CSRF is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform.

**Attack Vectors:**
- Exploiting cookie-based session handling
- Targeting actions with predictable parameters
- Creating malicious HTML pages
- Automatic form submission
- Exploiting GET request actions
- Bypassing weak CSRF defenses

**Bypass Techniques:**
- Circumventing CSRF token validation
- Exploiting weaknesses in SameSite cookies
- Manipulating Referer header validation
- Targeting applications with weak session management
- Using GET requests when POST expected
- Token not tied to user session
- Token not validated when present

**Key Points:**
- Requires three conditions: relevant action, cookie sessions, predictable parameters
- Delivery similar to reflected XSS
- Defenses: CSRF tokens, SameSite cookies, Referer validation
- CSRF tokens must be unpredictable and tied to session
- Validate tokens on server-side
- Use SameSite=Strict or Lax cookies
- Consider double-submit cookies pattern
- Impact: account takeover, unauthorized actions

---

### Cross-Origin Resource Sharing (CORS)
**URL:** https://portswigger.net/web-security/cors

**Description:**
CORS is a browser mechanism that enables controlled access to resources located outside of a given domain while extending the same-origin policy.

**Attack Vectors:**
- Server-generated ACAO from client Origin header
- Errors in parsing Origin headers
- Exploiting whitelisted `null` Origin values
- Leveraging XSS via CORS trust relationships
- Breaking TLS with poorly configured CORS
- Attacking intranet resources without credentials

**Bypass Techniques:**
- Registering domains matching whitelist patterns
- Generating requests with `null` Origin
- Exploiting XSS in trusted subdomains
- Intercepting HTTP/HTTPS traffic
- Exploiting subdomain takeovers
- Using sandbox iframes to get null origin

**Key Points:**
- Same-origin policy fundamentals
- `Access-Control-Allow-Origin` response header
- Credential handling in cross-origin requests
- Pre-flight checks with OPTIONS
- Prevention: only allow trusted sites
- Avoid wildcards and `null` origin whitelisting
- Implement server-side security policies
- Carefully validate and parse Origin headers
- Don't whitelist all subdomains

---

### Clickjacking
**URL:** https://portswigger.net/web-security/clickjacking

**Description:**
Clickjacking is an interface-based attack where a user is tricked into clicking on hidden actionable content by interacting with a decoy website.

**Attack Vectors:**
- Using CSS to create transparent iframe layers
- Overlaying target website's actionable elements
- Manipulating opacity and z-index
- Combining with DOM XSS attacks
- Multistep attacks with precise user interactions
- Prefilled form input attacks

**Bypass Techniques:**
- Circumventing frame busting scripts
- Using HTML5 iframe `sandbox` attribute
- Exploiting sites allowing iframe embedding
- Manipulating form inputs via GET parameters
- Neutralizing top-level navigation restrictions
- Disabling JavaScript in iframe

**Key Points:**
- Clickjacking with prefilled form inputs
- Multistep clickjacking scenarios
- Prevention: X-Frame-Options header
- Content Security Policy (CSP) `frame-ancestors`
- Frame busting scripts (less reliable)
- Tool: Burp's Clickbandit for PoC generation
- Impact: unauthorized actions, account deletion
- Test: can site be loaded in iframe?

---

### DOM-based Vulnerabilities
**URL:** https://portswigger.net/web-security/dom-based

**Description:**
DOM-based vulnerabilities occur when client-side JavaScript insecurely processes attacker-controllable data, passing it from a "source" to a dangerous "sink".

**Attack Vectors:**
- Manipulating URL parameters
- Exploiting web messages
- Injecting malicious data into client-side scripts
- Abusing browser storage mechanisms
- Exploiting jQuery selectors
- Document.write() sinks

**Bypass Techniques:**
- Identifying vulnerable JavaScript
- Constructing payloads for specific sinks
- Exploiting `eval()`, `document.write()`, `location` properties
- Using `#` fragments to avoid server-side detection
- DOM clobbering techniques
- Prototype pollution exploitation

**Key Points:**
- Sources: `location.search`, `location.hash`, `document.referrer`
- Sinks: `eval()`, `innerHTML`, `document.write()`, `location`
- Taint flow analysis required
- DOM clobbering attacks
- Prevention: validate/sanitize client-side data
- Use whitelisting for allowed content
- Proper encoding and escaping
- Avoid inserting untrusted data into sinks
- Variations: DOM XSS, open redirection, cookie manipulation

---

### WebSockets
**URL:** https://portswigger.net/web-security/websockets

**Description:**
WebSockets are long-lived connections with asynchronous communication used in modern web applications for transmitting sensitive information and performing user actions.

**Attack Vectors:**
- Manipulating WebSocket messages
- Intercepting and modifying message contents
- Exploiting input processing vulnerabilities
- Cross-site WebSocket hijacking (CSWSH)
- Attacking WebSocket handshake mechanisms
- Message injection attacks

**Bypass Techniques:**
- Injecting malicious payloads into WebSocket messages
- Manipulating HTTP headers during connection establishment
- Exploiting session handling flaws
- Bypassing input validation
- CSRF-like attacks on WebSocket handshake
- Man-in-the-middle attacks on `ws://`

**Key Points:**
- WebSocket connection establishment via HTTP upgrade
- Message structure and bidirectional transmission
- Potential for XSS, SQLi, and CSRF attacks
- Security: use `wss://` protocol (WebSocket over TLS)
- Hard-code WebSocket endpoint URLs
- Protect against CSRF in handshake
- Treat received data as untrusted
- Implement robust input validation
- Tool: Burp Suite for testing WebSocket security

---

## Advanced Topics

### Insecure Deserialization
**URL:** https://portswigger.net/web-security/deserialization

**Description:**
Insecure deserialization is when user-controllable data is deserialized by a website, potentially enabling attackers to manipulate serialized objects and inject harmful data.

**Attack Vectors:**
- Manipulating serialized object attributes
- Injecting arbitrary objects
- Exploiting "magic methods" in serialization
- Creating/using gadget chains
- Leveraging application functionality
- PHAR deserialization in PHP
- Memory corruption attacks

**Bypass Techniques:**
- Circumventing object validation checks
- Exploiting complex library dependencies
- Chaining method invocations across classes
- Manipulating serialized data formats
- Base64 encoding manipulation
- Exploiting custom deserialization logic

**Key Points:**
- Language-specific formats: PHP, Java, Ruby
- Object injection techniques
- Pre-built vs custom gadget chains
- Prevention: avoid deserializing user input
- Implement digital signatures on serialized data
- Create class-specific serialization methods
- Perform integrity checks before deserialization
- Severity: High - RCE, privilege escalation, file access
- Tools: ysoserial for Java gadgets

---

### Web LLM Attacks
**URL:** https://portswigger.net/web-security/llm-attacks

**Description:**
Large Language Model (LLM) attacks exploit AI systems integrated into websites, allowing attackers to manipulate models and access unauthorized data or functionality.

**Attack Vectors:**
- Prompt injection: crafting inputs to manipulate LLM behavior
- API exploitation: abusing APIs accessible to LLM
- Indirect prompt injection: malicious instructions in external content
- Training data poisoning: compromising model's training data
- Sensitive data leakage through strategic queries
- Excessive agency exploitation

**Bypass Techniques:**
- Using misleading context for privilege escalation
- Embedding fake system messages
- Inserting fabricated user responses
- Exploiting insufficient input validation
- Crafting "jailbreaker" prompts
- System prompt extraction

**Key Points:**
- Excessive agency: LLMs with inappropriate API access
- Insecure output handling: unvalidated model responses
- Chaining vulnerabilities through APIs
- Defense: treat LLM-accessible APIs as public
- Avoid feeding sensitive data to models
- Implement robust access controls
- Don't rely solely on prompt-based prevention
- Emerging threat with evolving attack techniques
- Model hallucinations can be weaponized

---

### GraphQL API Vulnerabilities
**URL:** https://portswigger.net/web-security/graphql

**Description:**
GraphQL vulnerabilities stem from implementation and design flaws, often enabling attackers to access unauthorized data or perform unintended actions.

**Attack Vectors:**
- Exploiting unsanitized arguments
- Introspection-based information disclosure
- Insecure direct object references (IDOR)
- Bypassing rate limiting using aliases
- Cross-site request forgery (CSRF)
- Query complexity exploitation

**Bypass Techniques:**
- Inserting special characters after `__schema` keyword
- Using alternative request methods (GET, form POST)
- Leveraging aliases to bypass rate limiting
- Exploiting endpoints without content-type validation
- Suggestion-based schema enumeration
- Batch query attacks

**Key Points:**
- Schema discovery through introspection
- Suggestion-based schema enumeration
- Query complexity and depth limitations
- Content type and request validation
- Mitigation: disable introspection in production
- Implement strict query complexity limits
- Validate content types properly
- Use secure CSRF token mechanisms
- Limit query depth and operation complexity
- GraphQL batching can bypass rate limits

---

### Server-Side Template Injection
**URL:** https://portswigger.net/web-security/server-side-template-injection

**Description:**
Server-side template injection is when an attacker is able to use native template syntax to inject a malicious payload into a template, which is then executed server-side.

**Attack Vectors:**
- Injecting template syntax into user input fields
- Exploiting concatenation of user input into templates
- Mathematical operation testing to detect vulnerability
- Identifying template engine through syntax probing
- Exploiting developer-supplied objects
- Chaining object methods for privilege escalation

**Bypass Techniques:**
- Using different template engine-specific syntax
- Manipulating template rendering processes
- Exploiting built-in objects and methods
- Breaking out of expression contexts
- Sandboxing bypass techniques
- Filter evasion with alternate syntax

**Key Points:**
- Plaintext context attacks
- Code context attacks (breaking out of expressions)
- Template engine identification critical
- Common engines: Jinja2, Twig, Freemarker, Velocity
- Impact: remote code execution, full server control
- Prevention: avoid user-modifiable templates
- Use "logic-less" template engines
- Implement strict input sanitization
- Deploy sandboxed environments
- Severity: Critical

---

### Web Cache Poisoning
**URL:** https://portswigger.net/web-security/web-cache-poisoning

**Description:**
Web cache poisoning is an advanced technique whereby an attacker exploits the behavior of a web server and cache so that a harmful HTTP response is served to other users.

**Attack Vectors:**
- Identify unkeyed inputs (headers, parameters)
- Manipulate server responses to include malicious payloads
- Trick cache into storing poisoned responses
- Exploit cache design and implementation flaws
- Target high-traffic pages for maximum impact
- Poison internal caches

**Bypass Techniques:**
- Manipulating cache keys
- Injecting unkeyed headers (`X-Forwarded-Host`, `X-Original-URL`)
- Exploiting cache parameter handling
- Targeting normalized cache keys
- Using Param Miner for automation
- Cache key normalization exploitation

**Key Points:**
- Cache key mechanics understanding critical
- Impact assessment based on page traffic
- Design vs implementation vulnerability types
- Potential outcomes: XSS, JavaScript injection, DoS
- Prevention: disable unnecessary headers
- Restrict caching to static content
- Carefully evaluate third-party technologies
- Patch client-side vulnerabilities
- Rewrite requests vs excluding from cache keys
- Tools: Burp's Param Miner extension

---

### HTTP Host Header Attacks
**URL:** https://portswigger.net/web-security/host-header

**Description:**
The HTTP Host header is a mandatory HTTP/1.1 request header. Vulnerabilities arise when websites implicitly trust and mishandle this header.

**Attack Vectors:**
- Password reset poisoning
- Web cache poisoning via Host header
- Routing-based SSRF
- Bypassing authentication
- Virtual host brute-forcing
- Exploiting server-side vulnerabilities

**Bypass Techniques:**
- Supplying arbitrary Host headers
- Checking for flawed validation
- Sending ambiguous requests
- Injecting host override headers (`X-Forwarded-Host`)
- Manipulating request lines
- Using absolute URLs in request line

**Key Points:**
- Virtual hosting scenarios create vulnerabilities
- Traffic routing through intermediaries
- Infrastructure misconfigurations common
- Implicit trust in header values dangerous
- Prevention: avoid Host header in server code
- Validate against whitelist of domains
- Disable host override headers
- Configure load balancers/proxies carefully
- Impact: password reset hijacking, SSRF, cache poisoning

---

### HTTP Request Smuggling
**URL:** https://portswigger.net/web-security/request-smuggling

**Description:**
HTTP Request Smuggling interferes with the way a website processes sequences of HTTP requests by exploiting inconsistencies in how front-end and back-end servers interpret request boundaries.

**Attack Vectors:**
- Manipulating `Content-Length` and `Transfer-Encoding` headers
- CL.TE: Front-end uses CL, back-end uses TE
- TE.CL: Front-end uses TE, back-end uses CL
- TE.TE: Obfuscating Transfer-Encoding header
- HTTP/2 request smuggling
- Browser-powered request smuggling

**Bypass Techniques:**
- Obfuscating Transfer-Encoding headers
- Exploiting HTTP/1.1 protocol ambiguities
- Manipulating request body parsing
- Chunked encoding manipulation
- Request tunneling techniques
- H2.CL and H2.TE variants

**Key Points:**
- Client-side desync attacks
- Response queue poisoning
- Request tunneling for hidden attacks
- Prevention: use HTTP/2 end-to-end
- Normalize ambiguous requests
- Reject requests violating specification
- Disable connection reuse to back-end
- Patch intermediary systems
- Impact: bypass security controls, poison caches, hijack sessions
- Severity: Critical

---

### OAuth Authentication
**URL:** https://portswigger.net/web-security/oauth

**Description:**
OAuth 2.0 is an authorization framework used for third-party authentication, allowing websites to access limited user data without exposing login credentials.

**Attack Vectors:**
- Improper implicit grant type implementation
- Exploiting weak token storage and validation
- Manipulating user data submission requests
- CSRF protection flaws
- Token and code leakage
- Scope validation bypasses

**Bypass Techniques:**
- Manipulating `redirect_uri` parameters
- Using localhost/subdomain tricks
- Exploiting URI parsing inconsistencies
- Server-side parameter pollution
- Stealing authorization codes
- Scope upgrade attacks

**Key Points:**
- Authorization Code vs Implicit Grant Types
- OpenID Connect extensions
- Client-side vs server-side implementation
- State parameter prevents CSRF
- Prevention: implement robust state validation
- Strictly validate `redirect_uri`
- Implement secure token storage
- Validate scope permissions thoroughly
- Use PKCE for mobile/SPA applications
- Never leak tokens in Referer header

---

### JWT Attacks
**URL:** https://portswigger.net/web-security/jwt

**Description:**
JWT (JSON Web Token) attacks exploit vulnerabilities in token-based authentication mechanisms, allowing attackers to bypass security controls and potentially compromise entire web applications.

**Attack Vectors:**
- Signature verification bypass
- Accepting arbitrary signatures
- Accepting tokens with no signature
- Manipulating token payload claims
- Secret key brute-forcing
- Header parameter injections (`jwk`, `jku`, `kid`)

**Bypass Techniques:**
- Setting `alg` header to `none`
- Embedding self-signed public keys
- Manipulating key identification mechanisms
- Exploiting inconsistent signature verification
- Algorithm confusion attacks (RS256 to HS256)
- Path traversal via `kid` parameter

**Key Points:**
- JWT format: header.payload.signature
- Difference between JWT, JWS, and JWE
- Cryptographic signature generation
- Header parameter exploitation techniques
- Prevention: use updated JWT libraries
- Implement strict signature verification
- Enforce algorithm whitelisting
- Validate and sanitize all token parameters
- Never trust user-supplied JWK
- Use strong secret keys (256+ bits)

---

### Prototype Pollution
**URL:** https://portswigger.net/web-security/prototype-pollution

**Description:**
Prototype pollution is a JavaScript vulnerability that enables an attacker to add arbitrary properties to global object prototypes, potentially leading to code execution.

**Attack Vectors:**
- URL query string manipulation
- JSON input injection
- Recursive object merging without sanitization
- Targeting `__proto__` to modify inheritance
- Exploiting configuration objects
- Targeting default settings

**Bypass Techniques:**
- Injecting properties via `__proto__`
- Using JSON parsing for malicious properties
- Targeting inherited properties in config objects
- Exploiting libraries with weak validation
- Constructor.prototype pollution
- Polluting Object.prototype

**Key Points:**
- Client-side: can lead to DOM XSS
- Server-side: potential remote code execution
- Sources: URL parameters, JSON inputs, web messages
- Requires: pollution source, sink, exploitable gadget
- Prevention: sanitize property keys
- Use Object.create(null) for dictionaries
- Freeze Object.prototype
- Validate JSON schema
- Use Map instead of objects
- Avoid recursive merge functions without validation

---

### Essential Skills
**URL:** https://portswigger.net/web-security/essential-skills

**Description:**
A guide to advanced web security testing techniques that go beyond basic lab scenarios, focusing on practical skills for real-world vulnerability discovery.

**Attack Vectors:**
- Payload obfuscation using various encoding methods
- Manual testing supplemented by automation
- Identifying subtle or hidden vulnerabilities
- Bypassing input filters and defense mechanisms
- Context-specific attacks

**Bypass Techniques:**
- URL encoding and double URL encoding
- HTML encoding
- XML encoding
- Unicode and hex escaping
- Multiple layered encoding techniques
- Context-specific decoding

**Key Points:**
- Simply copying lab solutions won't work on real sites
- Context-specific decoding is critical
- Scanning custom insertion points
- Handling non-standard data structures
- "Mystery lab challenge" for unknown vulnerabilities
- Tools: Burp Suite (Scanner, Professional, Enterprise)
- Emphasizes adaptability and creative thinking
- Combine manual expertise with automated tools
- Understanding encoding contexts is crucial
- Learn to identify obscure attack surfaces

---

## Summary

This pentesting plan of attack covers **31 major vulnerability categories** from the PortSwigger Web Security Academy:

- **14 Server-side vulnerabilities** - Focus on backend exploitation
- **6 Client-side vulnerabilities** - Target user browsers and sessions
- **11 Advanced topics** - Complex modern attack vectors

### Testing Methodology

1. **Reconnaissance**: Understand the application architecture
2. **Discovery**: Identify attack surfaces and entry points
3. **Analysis**: Test for vulnerabilities systematically
4. **Exploitation**: Develop and validate proof-of-concepts
5. **Documentation**: Record findings with evidence

### Key Tools Referenced

- Burp Suite (Scanner, Repeater, Intruder, Clickbandit)
- Param Miner extension
- Turbo Intruder extension
- JS Link Finder
- OpenAPI Parser
- Hashcat (for JWT/password cracking)
- ysoserial (for deserialization)

### General Prevention Principles

- **Input Validation**: Validate and sanitize all user input
- **Output Encoding**: Context-aware encoding for all output
- **Least Privilege**: Deny by default, allow explicitly
- **Defense in Depth**: Multiple layers of security controls
- **Secure Defaults**: Disable dangerous features by default
- **Regular Updates**: Keep frameworks and libraries current
- **Security Testing**: Integrate testing into development lifecycle

---

**Note**: This document is based on content from PortSwigger Web Security Academy as of October 2025. Always refer to the official documentation for the most up-to-date information and detailed lab exercises.

**Credits**: PortSwigger Web Security Academy (https://portswigger.net/web-security)
